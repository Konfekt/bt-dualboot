#!/usr/bin/env bash

echo "TIPS:"
echo "  --pdb       drop to debugger on failure"
echo "  --pdb -x    drop to PDB on first failure, then end test session"
echo

UNIT_ACCEPTANCE_DIR=tests/

TEST_CMD="pytest"
for arg do
  shift
  
  case "$arg" in
    "--watch")
      # see https://johnfraney.ca/blog/pytest-watched-failed-tests/
      TEST_CMD="ptw -- --last-failed --new-first -v"
      ;;

    *)
      set -- "$@" "$arg"
  esac
done

$TEST_CMD "$UNIT_ACCEPTANCE_DIR" "$@"
